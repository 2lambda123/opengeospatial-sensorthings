[[staplus-entities]]
== STAplus Entity Type Requirements

`Party`, `License`, `ObservationGroup`, `Relation`, and `Campaign` are the STAplus entity types. 

In this section, the properties for each STAplus entity type and the direct relation to other entity types are explained. 

NOTE: Please be aware that all of the Requirements Classes in this section are part of the Conformance Class <<conformance_class_core>>.

[[common-control-information]]
=== Requirements Class *Entity Control Information*

NOTE: For more information, please see https://docs.ogc.org/is/18-088/18-088.html#common-control-information[<<OGC18-088, OGC SensorThings API Part 1: Sensing Version 1.1, ยง8.1>>].

[requirements_class]
.Entity Control Information

====
[%metadata]
identifier:: {identifier}/req-class/entity-control-information
obligation:: requirement
subject:: Target Type: Implementation
inherit:: <<OGC15-078r6>> or <<OGC18-088>>
requirement:: {identifier}/req/common-control-information
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/common-control-information

Each STAplus entity SHALL have the following common control information listed in <<tab-common-control-information>>.
====

[[tab-common-control-information]]
.Common control information
[cols="20a,50a,15a,15a"]
|===
|Name |Definition |Data type |Multiplicity and use

|id
|`id` is the system-generated identifier of an entity that is unique among the entities of the same entity type in a SensorThings API service instance.
|Any
|One (mandatory)

|selfLink
|`selfLink` is the absolute URL of an entity that is unique among all other entities.
|URL
|One (mandatory)

|navigationLink
|`navigationLink` is the relative or absolute URL that retrieves content of related entities.
|URL
|One-to-many +
(mandatory)
|===

[[party]]
=== Requirements Class *Party*

The `Party` entity can be used to represent acting users and to model ownership. 

One example for ownership is that a satellite `Thing` is owned by a space agency. This ownership may entitle the space agency to be the only party that can update the thing's location. Other parties can then mount their sensor on the satellite and provide `Datastream`, or `MultiDatastream` entities to upload observations generated by their sensors. Via the association to the `Datastream` resp. `MultiDatastream` their ownership of the observations is guaranteed. By associating a license to the (multi)datastream, they could also define re-use conditions. 

[requirements_class]
.Party

====
[%metadata]
identifier:: {identifier}/req-class/party
obligation:: requirement
subject:: Target Type: Implementation
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/party/properties
requirement:: {identifier}/req/party/relations
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/party/properties

Each `Party` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-party>>.
====

[[tab-properties-party]]
.Properties of a `Party` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|role
|This is the role of the party
|CharacterString ['individual', 'institutional']
|One (mandatory)

|description
|This is a short description of the party
|CharacterString
|Zero or One (optional)

|displayName
|A property commonly used for saluting the party
|CharacterString
|Zero or One (optional)

|authId
|A system wide unique property (e.g., `REMOTE_USER` or `SUB` from authentication) to uniquely identify the party
|CharacterString
|Zero or One (optional)

|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/party/relations

An implementation SHALL allow each `Party` to have direct associations to other entity types listed in <<tab-relations-from-party>> and <<tab-relations-to-party>>.
====

[[tab-relations-from-party]]
.Direct relation from a `Party` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Datastreams
|Datastream
|Zero to Many
|A `Party` has zero-to-many `Datastreams`.

|MultiDatastreams (optional)
|MultiDatastream
|Zero to Many 
|A `Party` has zero-to-many `MultiDatastreams`.

|Things
|Thing
|Zero to Many
|A `Party` has zero-to-many `Things`.

|ObservationGroups
|ObservationGroup
|Zero to Many
|A `Party` has zero-to-many `ObservationGroups`.

|Campaigns
|Campaign
|Zero to Many
|A `Party` has zero-to-many `Campaigns`.
|===

[[tab-relations-to-party]]
.Direct relation from a SensorThings entity type to `Party`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|Party
|Datastream
|Zero or One
|A `Datastream` has zero-to-one `Party`.

|Party (optional)
|MultiDatastream
|Zero or One
|A `MultiDatastream` has zero-to-one `Party`.

|Party
|Thing
|Zero or One
|A `Thing` has zero-to-one `Party`.

|===

[[license]]
=== Requirements Class *License*

The `License` entity can be used to associate a re-use condition to observations via a `Datastream` or `MultiDatastream`. It can also be used to express re-use conditions for an `ObservationGroup` or `Campaign`.

[requirements_class]
.License

====
[%metadata]
identifier:: {identifier}/req-class/license
obligation:: requirement
subject:: Target Type: Implementation
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/license/properties
requirement:: {identifier}/req/license/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/license/properties

Each `License` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-license>>.
====


[[tab-properties-license]]
.Properties of a `License` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|name
|A property provides a label for `License` entity, commonly a descriptive name.
|CharacterString
|One (mandatory)

|description
|This is a short description of the corresponding `License` entity.
|CharacterString
|Zero or One (optional)

|definition
|This is a URI referencing the `License` entity.
|URI
|One (mandatory)

|logo
|This is the URI of the logo for the `License` entity.
|CharacterString
|Zero or One (optional)

|attributionText
|The text to be used as attribution when mandated by the license.
|CharacterString
|Zero or One (optional)
|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/license/relations

An implementation SHALL allow each `License` to have direct associations to other entity types listed in <<tab-relations-from-license>> and <<tab-relations-to-license>>.
====

[[tab-relations-from-license]]
.Direct relation from a `License` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Datastreams
|Datastream
|Zero to Many
|A `License` has zero-to-many `Datastreams`.

|MultiDatastreams (optional)
|MultiDatastream
|Zero to Many
|A `License` has zero-to-many `MultiDatastreams`.

|Campaigns
|Campaign
|Zero to Many
|A `License` has zero-to-many `Campaigns`.

|ObservationGroups
|ObservationGroup
|Zero to Many
|A `License` has zero-to-many `ObservationGroups`.
|===

[[tab-relations-to-license]]
.Direct relation from a SensorThings entity type to `License`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|License
|Datastream
|Zero or One
|A `Datastream` MAY have zero-to-one `License`.

|License (optional)
|MultiDatastream
|Zero or One
|A `MultiDatastream` MAY have zero-to-one `License`.

|===

[[group]]
=== Requirements Class *ObservationGroup*

The `ObservationGroup` entity is a bag of observations and/or relations that can be shared and re-used.

[requirements_class]
.ObservationGroup

====
[%metadata]
identifier:: {identifier}/req-class/group
obligation:: requirement
subject:: Target Type: Implementation
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/group/properties
requirement:: {identifier}/req/group/relations
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/group/properties

Each `ObservationGroup` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-group>>.
====

[[tab-properties-group]]
.Properties of a `ObservationGroup` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|name
|A property provides a label for `ObservationGroup` entity, commonly a descriptive name.
|CharacterString
|One (mandatory)

|description
|This is a short description of the corresponding `ObservationGroup` entity.
|CharacterString
|One (mandatory)

|purpose
|This is a short description of the purpose for the `ObservationGroup` entity.
|CharacterString
|Zero or One (optional)

|creationTime
|This is the time when the `ObservationGroup` was created.
|TM Instant
|One (mandatory)

|endTime
|This is the end time of the `ObservationGroup` entity. The exact semantics depend on the business logic. 
|TM Instant
|Zero or One (optional)

|termsOfUse
|Express the term of use for the `ObservationGroup` entity.
|CharacterString
|Zero or One (optional)

|privacyPolicy
|Express the term of use for personal data that are contained in the `ObservationGroup` entity.
|CharacterString
|Zero or One (optional)

|dataQuality
|The quality information of the observations in the group
|JSON Object
|Zero or One (optional)

|properties
|The SensorThings API definition applies
|JSON Object
|Zero or One (optional)
|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/group/relations

An implementation SHALL allow each `ObservationGroup` to have direct associations to other entity types listed in <<tab-relations-from-group>> and <<tab-relations-to-group>>.
====

[[tab-relations-from-group]]
.Direct relation from a `ObservationGroup` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|License
|License
|Zero or One
|A `ObservationGroup` has zero-to-one `License`.

|Observations
|Observation
|Zero to Many
|A `ObservationGroup` has zero-to-many `Observations`.

|Relations
|Relation
|Zero to Many
|A `ObservationGroup` has zero-to-many `Relations`.

|Party
|Party
|Zero or One
|A `ObservationGroup` has zero-to-one `Party`.

|Campaigns
|Campaign
|Zero to Many
|A `ObservationGroup` has zero-to-many `Campaigns`.
|===

[[tab-relations-to-group]]
.Direct relation from a SensorThings entity type to `ObservationGroup`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|ObservationGroups
|Observation
|Zero to Many
|An `Observation` has zero-to-many `ObservationGroups`.

|===

[[relation]]
=== Requirements Class *Relation*

The `Relation` entity can either be used to describe relationships between two observations, or one observation and a resolvable external resource identified by a URI.

[requirements_class]
.Relation

====
[%metadata]
identifier:: {identifier}/req-class/relation
obligation:: requirement
subject:: Target Type: Implementation
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/relation/properties
requirement:: {identifier}/req/relation/relations
====

[requirement]
====
[%metadata]
identifier:: {identifier}/req/relation/properties

Each `Relation` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-relation>>.
====

[[tab-properties-relation]]
.Properties of a `Relation` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|role
|This URI references the definition of the `Relation` entity.
|URI
|One (mandatory)

|description
|This is a short description of the corresponding `Relation` entity.
|CharacterString
|Zero or One (optional)

|externalResource
|This URI references the external resource for the `Relation` entity.
|URI
|Zero or One (optional)

|properties
|The SensorThings API definition applies
|JSON Object
|Zero or One (optional)
|===

NOTE: The subject of a relation entity is always an observation. For expressing the object of a relation, the `Object` relation XOR `externalResource` property must be used.

[requirement]
====
[%metadata]
identifier:: {identifier}/req/relation/relations

An implementation SHALL allow each `Relation` to have direct associations to other entity types listed in <<tab-relations-from-relation>>.
====

[[tab-relations-from-relation]]
.Direct relation from a `Relation` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Subject
|Observation
|Zero or One
|A `Relation` SHALL have one `Subject`.

|Object
|Observation
|Zero or One
|A `Relation` has zero-to-one `Object`.

|ObservationGroups
|ObservationGroup
|Zero to Many
|A `Relation` has zero-to-many `ObservationGroups`.
|===

NOTE: For expressing the object of a relation, the following constrain applies: `Object` relation XOR `externalResource` property.

[[tab-relations-to-relation]]
.Direct relation from a SensorThings entity type to `Relation`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|Objects
|Observation
|Zero to Many
|An `Observation/Subject`  has zero-to-many `Relation/Objects`.

|Subjects
|Observation
|Zero to Many
|An `Observation/Object` has zero-to-many `Relation/Subjects`.

|===

[[campaign]]
=== Requirements Class *Campaign*

The `Campaign` entity is a container of `Datastream` or `MultiDatastream` entities. A Campaign can have a particular purpose and a managing party.

[requirements_class]
.Campaign

====
[%metadata]
identifier:: {identifier}/req-class/campaign
obligation:: requirement
subject:: Target Type: Implementation
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/campaign/properties
requirement:: {identifier}/req/campaign/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/campaign/properties

Each `Campaign` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-campaign>>.
====

[[tab-properties-campaign]]
.Properties of a `Campaign` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|name
|A property provides a label for `Campaign` entity, commonly a descriptive name.
|CharacterString
|One (mandatory)

|description
|This is a short description of the corresponding `Campaign` entity.
|CharacterString
|One (mandatory)

|classification
|Determines if the data stream(s), multi data stream(s) or group(s) of the `Campaign` entity contain sensitive information.
|ValueCode
|Zero or One (optional)

|termsOfUse
|Express the term of use for the `Campaign` entity.
|CharacterString
|One (mandatory)

|privacyPolicy
|Express the terms of use for personal data that are contained in the `Campaign` entity.
|CharacterString
|Zero or One (optional)

|url
|This is the URL for the `Campaign` entity that provides additional information that cannot be captured in this entity alone.
|URL
|Zero or One (optional)

|creationTime
|This is the time when the `Campaign` entity was created. 
|TM Instant
|One (mandatory)

|startTime
|This is the starting time of the `Campaign` entity. The exact semantics depend on the business logic. 
|TM Instant
|Zero or One (optional)

|endTime
|This is the ending time of the `Campaign` entity. The exact semantics depend on the business logic. 
|TM Instant
|Zero or One (optional)

|properties
|The SensorThings API definition applies
|JSON Object
Zero or One (optional)
|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/campaign/relations

An implementation SHALL allow each `Campaign` to have direct associations to other entity types listed in <<tab-relations-from-campaign>> and <<tab-relations-to-campaign>>.
====

[[tab-relations-from-campaign]]
.Direct relation from a `Campaign` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Datastreams
|Datastream
|Zero to Many
|A `Campaign` has zero-to-many `Datastreams`.

|MultiDatastreams (optional)
|MultiDatastream
|Zero to Many
|A `Campaign` has zero-to-many `MultiDatastreams`.

|Party
|Party
|Zero or One
|A `Campaign` has zero-to-one `Party`.

|ObservationGroups
|ObservationGroup
|Zero to Many
|A `Campaign` has zero-to-many `ObservationGroup`.

|License
|License
|Zero or One
|A `Campaign` MAY have zero-to-one `License`.

|===

[[tab-relations-to-campaign]]
.Direct relation from a SensorThings entity type to `Campaign`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|Campaigns
|Datastream
|Zero to Many
|A `Datastream`  has zero-to-many `Campaigns`.

|Campaigns (optional)
|MultiDatastream
|Zero to Many
|A `MultiDatastream` has zero-to-many `Campaigns`.

|===
