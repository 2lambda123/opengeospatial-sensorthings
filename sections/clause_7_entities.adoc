[[staplus-entities]]
== STAplus Entity Type Requirements

`Party`, `License`, `ObservationGroup`, `Relation` and `Campaign` are the STAplus entity types. The implemented entities SHALL be listed in the response to a GET request to the root URL as described in Sensing part. 

An implementation SHALL implement all STAplus entities (with read access) as defined in the Core conformance class.

In this section, the properties for each entity type and the direct relation to the other entity types are explained. 

[[common-control-information]]
=== Requirements Class *Entity Control Information*

NOTE: In STA control information is represented as annotations whose names start with iot followed by a dot ( . ). Annotations are name/value pairs that have a dot ( . ) as part of the name.

When annotating a name/value pair for which the value is represented as a JSON object, each annotation is placed within the object and represented as a single name/value pair. In STA, the name always starts with the “at” sign (@), followed by the namespace iot, followed by a dot (.), followed by the name of the term (e.g., **"@iot.id":**1).

When annotating a name/value pair for which the value is represented as a JSON array or primitive value, each annotation that applies to this name/value pair is placed next to the annotated name/value pair and represented as a single name/value pair. The name is the same as the name of the name/value pair being annotated, followed by the “at” sign (**@**), followed by the namespace iot, followed by a dot (.), followed by the name of the term.  (e.g., `+"Locations@iot.navigationLink":"http://example.org/v1.0/Things(1)/Locations"+` or `+"Locations@iot.navigationLink":"http://example.org/v1.1/Things(1)/Locations"+`)

[requirements_class]
.Entity Control Information

====
[%metadata]
identifier:: {identifier}/req-class/entity-control-information
obligation:: requirement
subject:: Target Type: Web Service
inherit:: <<OGC15-078r6>> or <<OGC18-088>>
requirement:: {identifier}/req/common-control-information
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/common-control-information

Each entity SHALL have the following common control information listed in <<tab-common-control-information>>.
====

[[tab-common-control-information]]
.Common control information
[cols="20a,50a,15a,15a"]
|===
|Name |Definition |Data type |Multiplicity and use

|id
|`id` is the system-generated identifier of an entity that is unique among the entities of the same entity type in a SensorThings API service instance.
|Any
|One (mandatory)

|selfLink
|`selfLink` is the absolute URL of an entity that is unique among all other entities.
|URL
|One (mandatory)

|navigationLink
|`navigationLink` is the relative or absolute URL that retrieves content of related entities.
|URL
|One-to-many +
(mandatory)
|===


[[party]]
=== Requirements Class *Party*

The `Party` entity can be used to represent acting users and to model ownership. One example for ownership is that a satellite `Thing` is owned by a space agency. This ownership may entitle the space agency to be the only party that can update the thing's location. Other parties can then mount their sensor on the satellite and provide `Datastream` or `MultiDatastream` instances to upload observations. Via the association to the `Datastream` resp. `MultiDatastream` their ownership of the observations is guaranteed. By associating a license to the (multi)datastream, they could also define re-use conditions. 

[requirements_class]
.Party

====
[%metadata]
identifier:: {identifier}/req-class/party
obligation:: requirement
subject:: Target Type: Web Service
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/party/properties
requirement:: {identifier}/req/party/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/party/properties

Each `Party` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-party>>.
====

[[tab-properties-party]]
.Properties of a `Party` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|role
|This is the role of the party
|CharacterString ['individual', 'institutional']
|One (mandatory)

|description
|This is a short description of the party
|CharacterString
|Zero or One (optional)

|displayName
|A property commonly used for saluting the party
|CharacterString
|Zero or One (optional)

|authId
|A system wide unique property (e.g. `REMOTE_USER` or `SUB` from authentication) to identify the party
|CharacterString
|Zero or One (optional)

|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/party/relations

Each `Party` entity MAY have direct relations to other entity types listed in <<tab-relations-from-party>> and <<tab-relations-to-party>>.
====

[[tab-relations-from-party]]
.Direct relation from a `Party` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Datastreams
|Datastream
|Zero to Many (optional)
|A `Party` MAY have zero-to-many `Datastreams`.

|MultiDatastreams
|MultiDatastream
|Zero to Many (optional)
|A `Party` MAY have zero-to-many `MultiDatastreams`.

|Things
|Thing
|Zero to Many (optional)
|A `Party` MAY have zero-to-many `Things`.

|ObservationGroups
|ObservationGroup
|Zero to Many (optional)
|A `Party` MAY have zero-to-many `ObservationGroups`.

|Campaigns
|Campaign
|Zero to Many (optional)
|A `Party` MAY have zero-to-many `Campaigns`.
|===

[[tab-relations-to-party]]
.Direct relation from a SensorThings entity type to `Party`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|Party
|Datastream
|Zero to One (optional)
|A `Datastream` MAY have zero-to-one `Party`.

|Party
|MultiDatastream
|Zero to One (optional)
|A `MultiDatastream` MAY have zero-to-one `Party`.

|Party
|Thing
|Zero to One (optional)
|A `Thing` MAY have zero-to-one `Party`.

|===

[[license]]
=== Requirements Class *License*

The `License` entity can be used to associate a re-use condition to observations via a `Datastream` or `MultiDatastream`. It can also be used to express re-use conditions for a group (a set of observations).

[requirements_class]
.License

====
[%metadata]
identifier:: {identifier}/req-class/license
obligation:: requirement
subject:: Target Type: Web Service
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/license/properties
requirement:: {identifier}/req/license/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/license/properties

Each `License` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-license>>.
====


[[tab-properties-license]]
.Properties of a `License` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|name
|A property provides a label for `License` entity, commonly a descriptive name.
|CharacterString
|One (mandatory)

|description
|This is a short description of the corresponding `License` entity.
|CharacterString
|Zero or One (optional)

|definition
|This is a URI referencing the `License` entity.
|URI
|One (mandatory)

|logo
|This is the data URI encoding of the logo for the `License` entity.
|CharacterString
|Zero or One (optional)

|attributionText
|The text to be used as attribution when mandated by the license.
|CharacterString
|Zero or One (optional)
|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/license/relations

Each `License` entity MAY have direct relations to other entity types listed in <<tab-relations-from-license>> and <<tab-relations-to-license>>.
====

[[tab-relations-from-license]]
.Direct relation from a `License` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Datastreams
|Datastream
|Zero to Many (optional)
|A `License` MAY have zero-to-many `Datastreams`.

|MultiDatastreams
|MultiDatastream
|Zero to Many (optional)
|A `License` MAY have zero-to-many `MultiDatastreams`.

|Campaigns
|Campaign
|Zero to Many (optional)
|A `License` MAY have zero-to-many `Campaigns`.

|ObservationGroups
|ObservationGroup
|Zero to Many (optional)
|A `License` MAY have zero-to-many `ObservationGroups`.
|===

[[tab-relations-to-license]]
.Direct relation from a SensorThings entity type to `License`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|License
|Datastream
|Zero to One (optional)
|A `Datastream` MAY have zero-to-one `License`.

|License
|MultiDatastream
|Zero to One (optional)
|A `MultiDatastream` MAY have zero-to-one `License`.

|===

[[group]]
=== Requirements Class *ObservationGroup*

The `ObservationGroup` entity can be used to create a bag of observations and/or relations that can be shared and re-used.

[requirements_class]
.ObservationGroup

====
[%metadata]
identifier:: {identifier}/req-class/group
obligation:: requirement
subject:: Target Type: Web Service
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/group/properties
requirement:: {identifier}/req/group/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/group/properties

Each `ObservationGroup` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-group>>.
====

[[tab-properties-group]]
.Properties of a `ObservationGroup` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|name
|A property provides a label for `ObservationGroup` entity, commonly a descriptive name.
|CharacterString
|One (mandatory)

|description
|This is a short description of the corresponding `ObservationGroup` entity.
|CharacterString
|One (mandatory)

|purpose
|This is a short description of the purpose for the `ObservationGroup` entity.
|CharacterString
|Zero or One (optional)

|creationTime
|This is the starting time of the `ObservationGroup` entity. Depending on the business logic, after this time it could be possible to add observations or relations to the ObservationGroup.
|TM Instant
|One (mandatory)

|endTime
|This is the end time of the `ObservationGroup` entity. Depending on the business logic, after this time it is no longer possible to add observations or relations to the ObservationGroup. 
|TM Instant
|Zero or One (optional)

|termsOfUse
|Express the term of use for the `ObservationGroup` entity.
|CharacterString
|Zero or One (optional)

|privacyPolicy
|Express the term of use for personal data that are contained in the `ObservationGroup` entity.
|CharacterString
|Zero or One (optional)

|dataQuality
|The quality information of the observations in the group
|JSON Object
|Zero or One (optional)

|properties
|The SensorThings API definition applies
|JSON Object
|Zero or One (optional)
|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/group/relations

Each `ObservationGroup` entity MAY have direct relations to other entity types listed in <<tab-relations-from-group>> and <<tab-relations-to-group>>.
====

[[tab-relations-from-group]]
.Direct relation from a `ObservationGroup` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|License
|License
|Zero to One (optional)
|A `ObservationGroup` MAY have zero-to-one `License`.

|Observations
|Observation
|Zero to Many (optional)
|A `ObservationGroup` MAY have zero-to-many `Observations`.

|Relations
|Relation
|Zero to Many (optional)
|A `ObservationGroup` MAY have zero-to-many `Relations`.

|Party
|Party
|Zero to One (optional)
|A `ObservationGroup` MAY have zero-to-one `Party`.

|Campaigns
|Campaign
|Zero to Many (optional)
|A `ObservationGroup` MAY have zero-to-more `Campaign`.
|===

[[tab-relations-to-group]]
.Direct relation from a SensorThings entity type to `ObservationGroup`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|ObservationGroups
|Observation
|Zero to Many (optional)
|An `Observation` MAY have zero-to-many `ObservationGroups`.

|===

[[relation]]
=== Requirements Class *Relation*

The `Relation` entity can be used to describe relationships between (1) two observations, or (2) one observation and a resolvable external object identified by a URI.

[requirements_class]
.Relation

====
[%metadata]
identifier:: {identifier}/req-class/relation
obligation:: requirement
subject:: Target Type: Web Service
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/relation/properties
requirement:: {identifier}/req/relation/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/relation/properties

Each `Relation` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-relation>>.
====


[[tab-properties-relation]]
.Properties of a `Relation` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|externalResource
|This URI references the external resource for the `Relation` entity.
|URI
|Zero or One (optional)

|description
|This is a short description of the corresponding `Relation` entity.
|CharacterString
|Zero or One (optional)

|role
|This URI references the definition of `Relation` entity.
|URI
|One (mandatory)

|properties
|The SensorThings API definition applies
|JSON Object
|Zero or One (optional)
|===

NOTE: The subject of a relation entity is always an observation. For expressing the object of a relation, the `Object` relation XOR `externalResource` property must be used.

[requirement]
====
[%metadata]
identifier:: {identifier}/req/relation/relations

Each `Relation` entity MAY have direct relations to other entity types listed in <<tab-relations-from-relation>>.
====

[[tab-relations-from-relation]]
.Direct relation from a `Relation` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Subject
|Observation
|Zero to One (optional)
|A `Relation` SHALL have one `Subject`.

|Object
|Observation
|Zero to One (optional)
|A `Relation` MAY have zero-to-one `Object`.

|ObservationGroups
|ObservationGroup
|Zero to Many (optional)
|A `Relation` MAY have zero-to-many `ObservationGroups`.
|===

NOTE: For expressing the object of a relation, the following constrain applies: `Object` relation XOR `externalResource` property.

[[tab-relations-to-relation]]
.Direct relation from a SensorThings entity type to `Relation`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|Objects
|Observation
|Zero to Many (optional)
|An `Observation/Subject`  MAY have zero-to-many `Relation/Objects`.

|Subjects
|Observation
|Zero to Many (optional)
|An `Observation/Object` MAY have zero-to-many `Relation/Subjects`.

|===



[[campaign]]
=== Requirements Class *Campaign*

The `Campaign` entity can be used to create a container of `Datastream` or `MultiDatastream` entities. A Campaign can have a particular purpose and a managing party.

[requirements_class]
.Campaign

====
[%metadata]
identifier:: {identifier}/req-class/campaign
obligation:: requirement
subject:: Target Type: Web Service
inherit:: {identifier}/req-class/entity-control-information
requirement:: {identifier}/req/campaign/properties
requirement:: {identifier}/req/campaign/relations
====


[requirement]
====
[%metadata]
identifier:: {identifier}/req/campaign/properties

Each `Campaign` entity SHALL have the mandatory properties and MAY have the optional properties listed in <<tab-properties-campaign>>.
====

[[tab-properties-campaign]]
.Properties of a `Campaign` entity
[cols="20a,45a,20a,15a"]
|===
|Name |Definition |Data type |Cardinality and use

|name
|A property provides a label for `Campaign` entity, commonly a descriptive name.
|CharacterString
|One (mandatory)

|description
|This is a short description of the corresponding `Campaign` entity.
|CharacterString
|One (mandatory)

|classification
|Determines if the data stream(s), multi data stream(s) or group(s) of the `Campaign` entity contain sensitive information
|ValueCode
|Zero or One (optional)

|description
|This is a short description of the corresponding `Campaign` entity.
|CharacterString
|One (mandatory)

|creationTime
|This is the starting time of the `Campaign` entity. Depending on the business logic, after this time it could be possible to add observations or relations to the ObservationGroup.
|TM Instant
|One (mandatory)

|startTime
|This is the starting time of the `Campaign` entity. Depending on the business logic, before this time it is not possible to add observations or relations to the ObservationGroup. 
|TM Instant
|Zero or One (optional)

|endTime
|This is the ending time of the `Campaign` entity. Depending on the business logic, after this time it is no longer possible to add observations or relations to the ObservationGroup. 
|TM Instant
|Zero or One (optional)

|termsOfUse
|Express the term of use for the `Campaign` entity.
|CharacterString
|One (mandatory)

|privacyPolicy
|Express the term of use for personal data that are contained in the `Campaign` entity.
|CharacterString
|Zero or One (optional)

|url
|This is the URL for the `Campaign` entity that provides additional information that cannot be captured in this entity alone.
|URL
|Zero or One (optional)

|properties
|The SensorThings API definition applies
|JSON Object
Zero or One (optional)
|===

[requirement]
====
[%metadata]
identifier:: {identifier}/req/campaign/relations

Each `Campaign` entity MAY have direct relations to other entity types listed in <<tab-relations-from-campaign>> and <<tab-relations-to-campaign>>.
====

[[tab-relations-from-campaign]]
.Direct relation from a `Campaign` entity to other entity types
[cols="25a,25a,20a,30a"]
|===
|Relation name| Entity type |Cardinality |Description

|Datastreams
|Datastream
|Zero to Many (optional)
|A `Campaign` MAY have zero-to-many `Datastreams`.

|MultiDatastreams
|MultiDatastream
|Zero to Many (optional)
|A `Campaign` MAY have zero-to-many `MultiDatastreams`.

|Party
|Party
|Zero to One (optional)
|A `Campaign` MAY have zero-to-one `Party`.

|ObservationGroups
|ObservationGroup
|Zero to Many (optional)
|A `Campaign` MAY have zero-to-many `ObservationGroup`.

|License
|License
|Zero to One (optional)
|A `Campaign` MAY have zero-to-one `License`.

|===

[[tab-relations-to-campaign]]
.Direct relation from a SensorThings entity type to `Campaign`
[cols="25a,25a,20a,30a"]
|===
|Relation name| Source Entity type |Cardinality |Description

|Campaigns
|Datastream
|Zero to Many (optional)
|A `Datastream`  MAY have zero-to-many `Campaigns`.

|Campaigns
|MultiDatastream
|Zero to Many (optional)
|A `MultiDatastream` MAY have zero-to-many `Campaigns`.

|===
